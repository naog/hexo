title: 摆脱宽带运营商的劫持
date: 2015-01-29
categories: 电脑技巧
tags: 劫持
permalink: 10
---

宽带运营商对用户的劫持已经到了令人发指地步，目前我所在的宽带环境时刻出现的劫持行为有，DNS劫持和对百度搜索结果干预加尾巴的方式。对于DNS劫持最直接的办法就是其他的公用DNS，但目前在遇到无法解析域名的时候似乎不怎么奏效，干脆在HOSTS文件中屏蔽吧：
```
127.0.0.1    hndnserror1.wo.com.cn
127.0.0.1    hndnserror2.wo.com.cn
127.0.0.1    hndnserror3.wo.com.cn
127.0.0.1    hndnserror4.wo.com.cn
127.0.0.1    hndnserror5.wo.com.cn
127.0.0.1    hndnserror6.wo.com.cn
127.0.0.1    hndnserror7.wo.com.cn
127.0.0.1    hndnserror8.wo.com.cn
127.0.0.1    hndnserror9.wo.com.cn
```

第二种是对百度搜索结果的干预行为，会在结果的URL后加入一个类似tn=9541254的尾巴，造成搜索结果闪一下的情况，通过抓包工具发现了罪魁祸首来自于这个URL：`http://192.253.224.172:8014/d2/s.ashx` ，之前曾经在路由器中或者防火墙中屏蔽了这个IP，但现在似乎劫持升级了，两种方法均已失效，目前只能在`IP安全策略`中阻止这个IP的访问。

首先打开到（win8.1）控制面板—管理工具—本地安全策略。

在`IP安全策略，在本地计算机`项右键选择`管理IP筛选器列表和筛选器操作`。在`管理IP筛选器列表`项中添加规则，弹出窗口中名称随意如联通劫持，再按当前页添加，源地址选择`一个特定的IP地址或子网`，在下面填上抓包到的IP`192.253.224.172`，下面目标地址，选`我的IP地址`，镜像去勾。返回`筛选器操作`项，添加新筛选器，安全方法为阻止，常规中名称也为阻止，方便辨认。然后就可以关闭这个选项卡。

再在`IP安全策略，在本地计算机`项右键选择`创建IP安全策略`，名称填写`阻止劫持`，一路下一步，到编辑属性窗口，点击添加，分别在IP筛选器列表/筛选器操作中点选上一步建立的`联通劫持`和`阻止`。返回属编辑窗口在规则前打勾并确定。

这时`IP安全策略，在本地计算机`下就有了一个`阻止劫持`的项，里面的规则都是刚才两步已经设置好的，只需在上面右键点选分配即可完成所有操作，这时，再次使用百度搜索的时候，被强制加上的小尾巴已经不见了。